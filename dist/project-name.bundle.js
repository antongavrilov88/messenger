(()=>{"use strict";var t={807:(t,e,n)=>{n.d(e,{Z:()=>i});var s=n(645),a=n.n(s)()((function(t){return t[1]}));a.push([t.id,"body{background:#e5e5e5}.workspace__wrapper{position:absolute;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;height:100%;width:100%}.workspace__container{width:70%;height:75%;align-self:center;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;background:#ffe;box-shadow:0px 4px 4px rgba(0,0,0,.25);border-radius:25px}a:visited,a:active{color:#999}.chat-container__interlocutor-container{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;width:100%;height:10%}.chat-container__interlocutor-container .chat-container__interlocutor-container__avatar-container{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-self:start;height:60px;width:60px;margin-left:25px;border-radius:30px;background:#e5e5e5}.chat-container__interlocutor-container .chat-container__interlocutor-container__name{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-self:start;height:40px;width:30%;margin-left:25px;text-align:left}.messages-container{width:100%;height:75%;overflow-y:scroll;overflow-x:hidden !important;display:flex;flex-direction:column}.messages-container::-webkit-scrollbar{width:0}.my-message-container{position:relative;width:90%;height:fit-content;left:5%}.my-message-box{width:fit-content;height:fit-content;float:right;padding:5px;margin-bottom:3px;align-self:flex-end;border-radius:10px 10px 0 10px;background:#c8c8c9}.interlocutor-message-container{position:relative;width:90%;height:fit-content;left:5%}.interlocutor-message-box{width:fit-content;height:fit-content;float:left;padding:5px;margin-bottom:3px;align-self:flex-start;border-radius:10px 10px 10px 0;background:#c8c8c9}.message-form__container{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;width:100%;height:10%}.message-form{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-content:space-evenly;align-items:center;align-content:space-evenly;margin-left:1.5%;width:97%;height:100%}.message-form .message-form__message-input__container{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;align-self:center;width:85%}.message-form .message-form__file-attache-button{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-content:center;align-content:center;width:34px;height:34px;font-size:30px}.message-form .message-form__file-attache-button:hover{cursor:pointer}.message-form .message-form__message-input{width:100%;height:34px;background:#d4d4d4;border-radius:10px;outline:none !important;border:none !important}.message-form .message-form__message-input:hover,.message-form .message-form__message-input:focus{box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.message-form .message-form__send-button{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-content:center;align-content:center;width:34px;height:34px;border:none !important;outline:none !important;background:none;align-self:center;font-size:30px}.message-form .message-form__send-button:hover{cursor:pointer}.chat-container{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-content:space-between;align-items:center;width:50%;height:100%;background:#ffe;border-radius:0 25px 25px 0}.chat-container hr{width:90%;height:.5px;background-color:#555;border:0px none;height:1px;clear:both;background:#c9c7c7}.chat-container p{font-family:monospace;font-style:normal;font-weight:500;font-size:16px;line-height:15px;text-align:center}.chat-container__interlocutor-container{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;width:100%;height:10%}.chat-container__interlocutor-container .chat-container__interlocutor-container__avatar-container{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-self:start;height:60px;width:60px;margin-left:25px;border-radius:30px;background:#e5e5e5}.chat-container__interlocutor-container .chat-container__interlocutor-container__name{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-self:start;height:40px;width:30%;margin-left:25px;text-align:left}.messages-container{width:100%;height:75%;overflow-y:scroll;overflow-x:hidden !important;display:flex;flex-direction:column}.messages-container::-webkit-scrollbar{width:0}.my-message-container{position:relative;width:90%;height:fit-content;left:5%}.my-message-box{width:fit-content;height:fit-content;float:right;padding:5px;margin-bottom:3px;align-self:flex-end;border-radius:10px 10px 0 10px;background:#c8c8c9}.interlocutor-message-container{position:relative;width:90%;height:fit-content;left:5%}.interlocutor-message-box{width:fit-content;height:fit-content;float:left;padding:5px;margin-bottom:3px;align-self:flex-start;border-radius:10px 10px 10px 0;background:#c8c8c9}.message-form__container{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;width:100%;height:10%}.message-form{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-content:space-evenly;align-items:center;align-content:space-evenly;margin-left:1.5%;width:97%;height:100%}.message-form .message-form__message-input__container{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;align-self:center;width:85%}.message-form .message-form__file-attache-button{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-content:center;align-content:center;width:34px;height:34px;font-size:30px}.message-form .message-form__file-attache-button:hover{cursor:pointer}.message-form .message-form__message-input{width:100%;height:34px;background:#d4d4d4;border-radius:10px;outline:none !important;border:none !important}.message-form .message-form__message-input:hover,.message-form .message-form__message-input:focus{box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.message-form .message-form__send-button{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-content:center;align-content:center;width:34px;height:34px;border:none !important;outline:none !important;background:none;align-self:center;font-size:30px}.message-form .message-form__send-button:hover{cursor:pointer}.chat-container{display:flex;flex-wrap:wrap;justify-content:start;align-items:center;justify-content:space-between;align-items:center;width:50%;height:100%;background:#ffe;border-radius:0 25px 25px 0}.chat-container hr{width:90%;height:.5px;background-color:#555;border:0px none;height:1px;clear:both;background:#c9c7c7}.chat-container p{font-family:monospace;font-style:normal;font-weight:500;font-size:16px;line-height:15px;text-align:center}.chat-list__container__list{width:100%;height:90%;display:block;overflow-y:scroll;overflow-x:hidden !important}.chat-list__container__list ul{padding:0;margin-top:10px}.chat-list__container__list::-webkit-scrollbar{width:0}.chat-list__container hr{position:relative;width:90%;height:.5px;margin:auto;background-color:#555;border:0px none;height:1px;clear:both;background:#e5e5e5}.chat-list__item{position:relative;width:100%;height:70px;border-radius:5px}.chat-list__item:hover{box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.active{box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.chat-list__delete_button{position:relative}.chat-list__delete_button:hover{cursor:pointer;box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.chat-list__item__avatar__container{position:relative;width:47px;height:47px;left:10px;top:10px;border-radius:23.5px;background:#e5e5e5}.chat-list__item__last-message__container{position:absolute;width:193px;height:30px;left:67px;top:27px;font-family:monospace;font-style:normal;font-weight:500;font-size:12px;line-height:15px;overflow:hidden;color:#999}.chat-list__item__counter{position:relative;width:20px;height:20px;left:270px;bottom:30px;background:#3369f3;border-radius:10px;text-align:center;vertical-align:middle;font-family:monospace;font-style:normal;font-weight:700;font-size:16px;line-height:15px;color:#fff}.chat-list__item__time{position:relative;width:20px;height:20px;left:270px;bottom:45px;text-align:center;vertical-align:middle;font-family:monospace;font-style:normal;font-weight:500;font-size:12px;line-height:15px;color:#999}.chat-list__item__chat-author__container{position:absolute;width:193px;height:13px;left:67px;top:10px;font-family:monospace;font-style:normal;font-weight:600;font-size:13px;line-height:13px;color:#1e1e1e}.chat-list__container{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;align-content:space-evenly;width:25%;height:100%;border-radius:25px 0 0 25px;background:#f3f2f2;overflow-y:hidden}.chat-list__container__profile-link{width:100%;height:12px;padding-top:60px;padding-bottom:15px;padding-right:7.5%;font-family:monospace;font-style:normal;font-weight:500;font-size:12px;line-height:15px;text-align:right;color:#999}.logout-button{float:left;margin-left:7%}.logout-button:hover{cursor:pointer;box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.chat-users-list__container__list{width:100%;height:90%;display:block;overflow-y:scroll;overflow-x:hidden !important}.chat-users-list__container__list ul{padding:0;margin-top:10px}.chat-users-list__container__list::-webkit-scrollbar{width:0}.chat-users-list__container hr{position:relative;width:90%;height:.5px;margin:auto;background-color:#555;border:0px none;height:1px;clear:both;background:#e5e5e5}.chat-users-list__item{position:relative;width:100%;height:70px;border-radius:5px}.chat-users-list__item:hover{box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.chat-users-list__item_active{position:relative;width:100%;height:70px;border-radius:5px;box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.chat-users-list__delete_button{position:relative}.chat-users-list__delete_button:hover{cursor:pointer;box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.chat-list__add-user_button{position:relative}.chat-list__add-user_button:hover{cursor:pointer;box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.chat-users-list__item__avatar__container{position:relative;width:47px;height:47px;left:10px;top:10px;border-radius:23.5px;background:#e5e5e5}.chat-users-list__item__chat-author__container{position:absolute;width:193px;height:13px;left:67px;top:10px;font-family:monospace;font-style:normal;font-weight:600;font-size:13px;line-height:13px;color:#1e1e1e}.chat-list__search__container{width:90%;height:32px;margin-bottom:15px;background:#e5e5e5;border-radius:7px}.chat-list__search__input{width:100%;height:30px;font-family:monospace;line-height:1.2;font-size:18px;display:block;background:0 0;outline:none !important;border:none !important;transition:all .4s}.chat-list__search__container:hover,.chat-list__search__container:focus{box-shadow:0 0 5px #51cbee;border:1px solid #51cbee}.chat-users-list__container{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;align-content:space-evenly;width:25%;height:100%;border-radius:0 25px 25px 0;background:#f3f2f2;overflow-y:hidden;font-family:monospace;font-style:normal;font-weight:600;font-size:13px;line-height:13px;color:#1e1e1e}.chat-container__dummy__content{width:40%;height:5%;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:monospace;font-style:normal;font-weight:500;font-size:16px;line-height:15px;text-align:center}.error-container{width:45%;height:45%;align-self:center;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;flex-direction:column;text-align:center;vertical-align:middle;font-family:monospace;font-style:normal;font-weight:700;font-size:35px;line-height:15px;color:#363535}.form-wrapper{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;position:absolute;height:100%;width:100%}.container{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;width:340px;height:fit-content;align-self:center;background:#ffe;box-shadow:0px 4px 4px rgba(0,0,0,.25);border-radius:12px}.form-container{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;width:70%;height:85%;align-self:center;padding:25px;align-content:space-evenly}.form__title{width:100%;padding-bottom:20px;display:block;text-align:center;font-family:monospace;font-size:30px;color:#555;line-height:1.2;text-transform:uppercase}.form__input{width:100%;height:30px;font-family:monospace;line-height:1.2;font-size:18px;display:block;background:0 0;outline:none;border:1px solid #ddd;transition:all .4s}.form__input_valid{box-shadow:0 0 5px #068f3a;border:1px solid #068f3a}.form__input_invalid{box-shadow:0 0 5px #ee3e12;border:1px solid #ee3e12}.form__input__name{padding:10px;font-family:monospace;font-size:16px;color:#555;line-height:1.4;text-transform:uppercase}.form__submit-button{width:90%;height:55px;margin-top:20px;background:#333;border-radius:27.5px;transition:all .4s;outline:none !important;border:none !important;color:#f0fff0;font-weight:400;font-family:monospace;font-size:20px}.form__submit-button:hover{background:#57b846;cursor:pointer}.account__switch-button{width:45%;height:25px;margin-top:20px;margin-bottom:20px;border-radius:12px;transition:all .4s;outline:none !important;border:none !important;color:#333;font-size:large;font-weight:400;font-family:monospace;font-size:13px}.dialog-modal{position:fixed;left:0px;top:0px;width:100vw;visibility:hidden}.dialog-modal.open{visibility:visible}.dialog-modal__background{position:fixed;left:0px;top:0px;width:100vw;opacity:80%;height:100vh;background:#000;transform:translateY(-100%);transition:all .3s ease-in-out}.dialog-modal__background.open{transform:translateY(0)}.dialog-modal__content{position:fixed;width:25%;height:30%;left:37.5%;top:35%;background:#fff;box-shadow:0px 0px 6px rgba(0,0,0,.14);border-radius:12px;font-family:monospace;font-style:normal;font-weight:500;font-size:14px;line-height:15px;color:#292828;text-align:center;float:right;vertical-align:middle;z-index:100000000;transform:translateX(100vw);transition:all .3s ease-in-out}.dialog-modal__content.open{transform:translateX(0);transition-delay:.3s}.profile-info__wrapper{width:95%;height:100%;align-self:center;display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.profile-info-container{width:35%;height:fit-content;align-self:center;display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.profile-info-container__property{font-family:monospace;font-style:normal;font-weight:700;font-size:18px;line-height:15px;color:#363535;text-align:left;vertical-align:middle}.profile-info-container__value{position:relative;top:25px;width:25%;font-family:monospace;font-style:normal;font-weight:500;font-size:14px;line-height:15px;color:#999;text-align:right;float:right;vertical-align:middle}.profile-info-container hr{position:relative;width:100%;height:.5px;margin:auto;background-color:#555;border:0px none;height:1px;clear:both;background:#e5e5e5}.profile-info-container__form{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;align-content:space-evenly;flex-direction:column;width:95%}.profile-info-container__avatar{align-self:center;width:130px;height:130px;border-radius:65px;background:#efefef}.profile-info-container__avatar:hover,.profile-info-container__avatar:focus{box-shadow:0 0 5px #51cbee;border:1px solid #51cbee;cursor:pointer}.profile-info-container__item{display:flex;flex-wrap:wrap;width:95%;justify-content:space-between;flex-direction:row}.profile-info-container__item__prop-name{justify-self:start;align-self:start}.profile-info-container__item__prop-input{justify-self:end;align-self:end;width:75%}.profile-info-container__submit-button{justify-self:end;width:60%;height:55px;margin-top:40px;background:#333;border-radius:27.5px;transition:all .4s;outline:none !important;border:none !important;color:#f0fff0;font-size:large;font-weight:400;font-family:monospace;font-size:20px}.profile-info-container__submit-button:hover{background:#57b846;cursor:pointer}.modal-dialog__submit-button{position:relative;width:40%;height:55px;margin-left:5%;margin-top:15%;background:#333;border-radius:27.5px;transition:all .4s;outline:none !important;border:none !important;color:#f0fff0;font-size:large;font-weight:400;font-family:monospace;font-size:20px}.modal-dialog__submit-button:hover{background:#57b846;cursor:pointer}.modal-dialog__body{position:relative;margin-top:15%;font-family:monospace;font-style:normal;font-weight:500;font-size:14px;line-height:15px;color:#292828;text-align:center;vertical-align:middle}.change-input{font-family:monospace;line-height:1.2;font-size:18px;display:block;width:30%;float:right;background:0 0;height:20px;margin:auto;top:25px;outline:none;border:1px solid #ddd;text-align:left;transition:all .4s;outline:none !important;border:none !important}.return-container{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;flex-direction:column;width:5%;height:100%;border-radius:25px 0 0 25px;background-color:#ebe4eb}.return-container__button{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;flex-direction:column;width:38px;height:38px;border-radius:19px}.return-container:hover{background:#dfdbdf;cursor:pointer}",""]);const i=a},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,s){"string"==typeof t&&(t=[[null,t,""]]);var a={};if(s)for(var i=0;i<this.length;i++){var r=this[i][0];null!=r&&(a[r]=!0)}for(var o=0;o<t.length;o++){var l=[].concat(t[o]);s&&a[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),e.push(l))}},e}},379:(t,e,n)=>{var s,a=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),i=[];function r(t){for(var e=-1,n=0;n<i.length;n++)if(i[n].identifier===t){e=n;break}return e}function o(t,e){for(var n={},s=[],a=0;a<t.length;a++){var o=t[a],l=e.base?o[0]+e.base:o[0],c=n[l]||0,d="".concat(l," ").concat(c);n[l]=c+1;var p=r(d),u={css:o[1],media:o[2],sourceMap:o[3]};-1!==p?(i[p].references++,i[p].updater(u)):i.push({identifier:d,updater:f(u,e),references:1}),s.push(d)}return s}function l(t){var e=document.createElement("style"),s=t.attributes||{};if(void 0===s.nonce){var i=n.nc;i&&(s.nonce=i)}if(Object.keys(s).forEach((function(t){e.setAttribute(t,s[t])})),"function"==typeof t.insert)t.insert(e);else{var r=a(t.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(e)}return e}var c,d=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function p(t,e,n,s){var a=n?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(t.styleSheet)t.styleSheet.cssText=d(e,a);else{var i=document.createTextNode(a),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(i,r[e]):t.appendChild(i)}}function u(t,e,n){var s=n.css,a=n.media,i=n.sourceMap;if(a?t.setAttribute("media",a):t.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleSheet)t.styleSheet.cssText=s;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(s))}}var h=null,m=0;function f(t,e){var n,s,a;if(e.singleton){var i=m++;n=h||(h=l(e)),s=p.bind(null,n,i,!1),a=p.bind(null,n,i,!0)}else n=l(e),s=u.bind(null,n,e),a=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return s(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;s(t=e)}else a()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var n=o(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var s=0;s<n.length;s++){var a=r(n[s]);i[a].references--}for(var l=o(t,e),c=0;c<n.length;c++){var d=r(n[c]);0===i[d].references&&(i[d].updater(),i.splice(d,1))}n=l}}}},151:(t,e,n)=>{function s(t){return function(t){return"object"==typeof t&&null!==t&&t.constructor===Object&&"[object Object]"===Object.prototype.toString.call(t)}(t)||function(t){return Array.isArray(t)}(t)}function a(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const[n,i]of Object.entries(t)){const t=e[n];if(s(i)&&s(t)){if(a(i,t))continue;return!1}if(i!==t)return!1}return!0}function i(t,e){const n=document.querySelector(t);return n&&n.appendChild(e.getContent()),e.addListeners(),n}n.d(e,{N:()=>Xt});class r{constructor(t){if(r.__instance)return r.__instance;this.routes=[],this.history=window.history,this._currentRoute=null,this._rootQuery=t,r.__instance=this}use(t,e){const n=new class{constructor(t,e,n){this._pathname=t,this._blockClass=e,this._block=null,this._props=n}navigate(t){this.match(t)&&this._block.show()}leave(){this._block.hide()}match(t){return t===this._pathname}render(){if(!this._block)return this._block=new this._blockClass,void i(this._props.rootQuery,this._block);this._block.show()}}(t,e,{rootQuery:this._rootQuery});return this.routes.push(n),this}start(){window.onpopstate=t=>{this._onRoute(t.currentTarget.location.pathname)},this._onRoute(window.location.pathname)}_onRoute(t){const e=this.getRoute(t);t&&e?(this._currentRoute&&this._currentRoute.leave(),this._currentRoute=e,e.render()):this.go("/404")}go(t){this.history.pushState({},"",t),this._onRoute(t)}back(){window.history.back()}forward(){window.history.forward()}getRoute(t){return this.routes.find((e=>e.match(t)))}}const o=r,l=class{constructor(){this.listeners={}}on(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}off(t,e){if(!this.listeners[t])throw new Error(`Нет события: ${t}`);this.listeners[t]=this.listeners[t].filter((t=>t!==e))}emit(t,...e){if(!this.listeners[t])throw new Error(`Нет события: ${t}`);this.listeners[t].forEach((function(t){t(...e)}))}};function c(t,e){for(let n in e)"object"!=typeof t[n]?t[n]=e[n]:"object"==typeof e[n]&&(t[n]=c(t[n],e[n]));return t}class d{constructor(t="div",e={}){this._element=null,this.props={},this.setProps=t=>{t&&Object.assign(this.props,t)};const n=new l;this._meta={tagName:t,props:e},this.props=this._makePropsProxy(e),this.eventBus=()=>n,this._registerEvents(n),n.emit(d.EVENTS.INIT)}_registerEvents(t){t.on(d.EVENTS.INIT,this.init.bind(this)),t.on(d.EVENTS.FLOW_CDM,this._componentDidMount.bind(this)),t.on(d.EVENTS.FLOW_CDU,this._componentDidUpdate.bind(this)),t.on(d.EVENTS.FLOW_RENDER,this._render.bind(this)),t.on(d.EVENTS.FLOW_ADD_LISTENERS,this.addListeners.bind(this))}_createResources(){const{tagName:t}=this._meta;this._element=this._createDocumentElement(t)}init(){this._createResources(),this.eventBus().emit(d.EVENTS.FLOW_CDM)}_componentDidMount(){this.componentDidMount(),this.eventBus().emit(d.EVENTS.FLOW_RENDER)}componentDidMount(){}_componentDidUpdate(t,e){a(t,e)&&(this.componentDidUpdate(t,e),this._render(),this.eventBus().emit(d.EVENTS.FLOW_ADD_LISTENERS))}componentDidUpdate(t=null,e=null){}get element(){return this._element}_render(){const t=this.render();t&&this._element&&(this._element.innerHTML=t)}compile(t,e){return window.Handlebars.compile(t)(e)}render(){}getContent(){return this.element}_makePropsProxy(t){const e=this;return new Proxy(t,{get(t,e){const n=t[e];return"function"==typeof n?n.bind(t):n},set(t,n,s){const a=c({},t);return t[n]=s,e.eventBus().emit(d.EVENTS.FLOW_CDU,a,t),!0},deleteProperty(){throw new Error("Нет доступа")}})}_createDocumentElement(t){return document.createElement(t)}show(){}addListeners(){}}d.EVENTS={INIT:"init",FLOW_CDM:"flow:component-did-mount",FLOW_CDU:"flow:component-did-update",FLOW_RENDER:"flow:render",FLOW_ADD_LISTENERS:"flow:add-listeners"};const p=d,u=class extends p{constructor(t){super("main",t)}render(){return this.compile('<div class="form-wrapper">\n                        <div class="container">\n                            {{{content}}}\n                        </div>\n                    </div>',{content:this.props.content.map((t=>t.render())).join("")})}},h=function(t,e=null){return t.name+`(${e})`};function m(t){const e=t.value;let n=!1;n={first_name:t=>t.length>4,second_name:t=>t.length>4,display_name:t=>t.length>4,login:t=>t.length>4,message:t=>t.length>4,title:t=>t.length>4,password:t=>t.length>6,oldPassword:t=>t.length>6,newPassword:t=>t.length>6,email:t=>/[A-Z0-9._%+-]+@[A-Z0-9-]+.+.[A-Z]{2,4}/gim.test(t),phone:t=>/\+\d{1,3}\s?\(\d{3}\)\s?\d{3}(-\d{2}){2}/g.test(t)}[t.name](e);let s=t.classList[1];return s&&t.classList.remove(s),n?t.classList.add("form__input_valid"):t.classList.add("form__input_invalid"),n}window.validateInput=m;const f=m,g=class extends p{constructor(t){super("button",t)}render(){return this.compile('<button  class=\'{{className}}\' type="{{type}}" id="{{id}}">\n                        {{text}}\n                    </button>',{className:this.props.className,type:this.props.type,text:this.props.text,id:this.props.id})}},_={className:"account__switch-button",type:"",text:"Еще нет аккаунта",id:"switchToSignUpButton"},b={className:"form-container",id:"loginForm",title:"Авторизация",submitButton:new g({className:"form__submit-button",type:"submit",text:"Войти",id:"signInButton"}),inputs:[{lable:{className:"form__input__name",title:"ЛОГИН"},input:{className:"form__input",type:"text",name:"login"},handler:h(f,"this")},{lable:{className:"form__input__name",title:"ПАРОЛЬ"},input:{className:"form__input",type:"password",name:"password"},handler:h(f,"this")}]},x=class extends p{constructor(t){super("form",t)}render(){return this.compile('<form class={{className}} id={{id}}>\n                        <span class="form__title">{{title}}</span>\n                        {{#each inputs}}\n                            <label class="{{this.lable.className}}"> {{this.lable.title}}\n                                <input class="{{this.input.className}}" type="{{this.input.type}}" name="{{this.input.name}}" placeholder="{{this.input.placeholder}}" onfocus="{{this.handler}}" onblur="{{this.handler}}"/>\n                            </label>\n                        {{/each}}\n                        {{{submitButton}}}\n                    </form>',{title:this.props.title,inputs:this.props.inputs,className:this.props.className,id:this.props.id,submitButton:this.props.submitButton.render()})}};class w{constructor(t={}){if(this.state={auth:{title:""},reg:{title:""}},w._instance)throw new Error("Can not create new instance");w._instance=this;const e=new l;this.eventBus=()=>e,this._registerEvents(e),this.state=this._makeStateProxy(t)}static getInstance(){return w._instance||(w._instance=new w),w._instance}_registerEvents(t){t.on(w.EVENTS.FLOW_SDU,this._storeDidUpdate.bind(this))}subscribe(t){this.eventBus().on(w.EVENTS.FLOW_SNSTP,t)}_storeDidUpdate(t={},e={}){this.storeDidUpdate(t,e)&&this.eventBus().emit(w.EVENTS.FLOW_SNSTP,e)}storeDidUpdate(t,e){return a(t,e)}_makeStateProxy(t){const e=this;return new Proxy(t,{get(t,e){const n=t[e];return"function"==typeof n?n.bind(t):n},set:(t,n,s)=>(t[n]=s,e.eventBus().emit(w.EVENTS.FLOW_SDU,Object.assign({},t),t),!0),deleteProperty(){throw new Error("Нет доступа")}})}}w.EVENTS={FLOW_SDU:"flow:store-did-update",FLOW_SNSTP:"flow:set-new-state-to-props"},w.setState=t=>{if(!t)return;const e=w.getInstance();Object.assign(e.state,t)};const y=w,v="ON_LOGIN",E="ON_SIGNUP",T="ON_LOAD",O="ON_CHANGE_PASSWORD",k="ON_AVATAR_CHANGE",C="ON_LOGOUT",N="ON_CREATE_CHAT",j="ON_CHAT_LIST_LOAD",L="ON_DELETE_CHAT",S="ON_CHAT_USERS_LIST_LOAD",U="ON_SEARCH_USER_BY_LOGIN",P="ON_ADD_CHAT_USER",B="ON_DELETE_USER_FROM_CHAT",A="ON_CHANGE_CHAT_AVATAR",I="ON_CHAT_LOADED",H="ON_MESSAGE_RECIEVED",D=y.getInstance();let M=D.state;M=(t=>Object.assign(Object.assign({},t),{user:{userData:null,userID:null,error:null}}))(M),M=(t=>Object.assign(Object.assign({},t),{auth:{status:!1}}))(M),M=(t=>Object.assign(Object.assign({},t),{chats:{data:null,listUpdated:!1},chat:{users:null,listUpdated:!1},usersToAdd:[],currentChatToken:null,currentChat:{},currentChatMessages:[]}))(M);var F=function(t,e,n,s){return new(n||(n=Promise))((function(a,i){function r(t){try{l(s.next(t))}catch(t){i(t)}}function o(t){try{l(s.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,o)}l((s=s.apply(t,e||[])).next())}))};const R=t=>F(void 0,void 0,void 0,(function*(){var e;t.payload&&t.payload instanceof Promise&&(t=Object.assign(Object.assign({},t),{payload:yield(e=t.payload,F(void 0,void 0,void 0,(function*(){let t=yield e.then((t=>t));try{return JSON.parse(t.response)}catch(e){return t.response}})))})),(t=>{switch(t.type){case v:case E:y.setState(Object.assign(Object.assign({},D.state),{auth:Object.assign(Object.assign({},D.state.auth),{status:!t.payload.reason})}));break;case C:y.setState(Object.assign(Object.assign({},D.state),{auth:Object.assign(Object.assign({},D.state.auth),{status:!1})}));break;case T:y.setState(Object.assign(Object.assign({},D.state),{auth:Object.assign(Object.assign({},D.state.auth),{status:!t.payload.reason})}))}})(t),(t=>{switch(t.type){case T:console.log(t.payload,"USER IS OK"),y.setState(Object.assign(Object.assign({},D.state),{user:t.payload,userProfileUpdated:!1})),console.log(D.state,"USER IS OK");break;case O:y.setState(Object.assign(Object.assign({},D.state),{user:Object.assign(Object.assign({},D.state.user),{passwordChanged:!t.payload.message})}));break;case k:y.setState(Object.assign(Object.assign({},D.state),{userProfileUpdated:!0}))}})(t),(t=>{switch(t.type){case N:case L:case A:y.setState(Object.assign(Object.assign({},D.state),{chats:Object.assign(Object.assign({},D.state.chats),{listUpdated:!0})}));break;case j:y.setState(Object.assign(Object.assign({},D.state),{chats:Object.assign(Object.assign({},D.state.chats),{data:t.payload.reason?null:t.payload,listUpdated:!1})}));break;case S:y.setState(Object.assign(Object.assign({},D.state),{chat:Object.assign(Object.assign({},D.state.chat),{users:t.payload.reason?null:t.payload,listUpdated:!1}),usersToAdd:[]}));break;case U:y.setState(Object.assign(Object.assign({},D.state),{usersToAdd:0===t.payload.length?[]:t.payload}));break;case P:case B:y.setState(Object.assign(Object.assign({},D.state),{chat:Object.assign(Object.assign({},D.state.chat),{listUpdated:!0})}));break;case I:y.setState(Object.assign(Object.assign({},D.state),{currentChatToken:t.payload.reason?null:t.payload.token,currentChatMessages:[]}));break;case H:y.setState(Object.assign(Object.assign({},D.state),{currentChatMessages:[...D.state.currentChatMessages,...t.payload]}))}})(t)})),q=function(t){if(!document.getElementById(t))return;let e=document.getElementById(t),n=e.getElementsByTagName("input"),s={};for(let t=0;t<n.length;t++)s[`${n[t].name}`]=n[t].value;return function(t){if(!t)return;const e=t.getElementsByTagName("input");let n=!0;for(let t=0;t<e.length;t++)if(!f(e[t]))return n=!1,n;return n}(e)?{data:JSON.stringify(s)}:void 0};var z;!function(t){t.GET="GET",t.POST="POST",t.PUT="PUT",t.PATCH="PATCH",t.DELETE="DELETE"}(z||(z={}));const W=class{constructor(t){this._baseURL="https://ya-praktikum.tech/api/v2",this._subURL="",this._subURL=t}get(t,e={}){return this.request(t,Object.assign(Object.assign({},e),{method:z.GET}))}post(t,e={}){return this.request(t,Object.assign(Object.assign({},e),{method:z.POST}))}put(t,e={}){return this.request(t,Object.assign(Object.assign({},e),{method:z.PUT}))}delete(t,e={}){return this.request(t,Object.assign(Object.assign({},e),{method:z.DELETE}))}request(t,e){let{method:n,data:s,headers:a}=e;return new Promise(((i,r)=>{const o=new XMLHttpRequest;o.open(n,`${this._baseURL}${this._subURL}${t}`);const l=a?e.data:s;a||o.setRequestHeader("Content-Type","application/json"),o.withCredentials=!0,o.onload=function(){i(o)},o.onabort=r,o.onerror=r,o.ontimeout=r,n!==z.GET&&l?o.send(l):o.send()}))}};class V{create(t){throw new Error("Not implemented")}get(){throw new Error("Not implemented")}update(t){throw new Error("Not implemented")}delete(){throw new Error("Not implemented")}}const $=new W("/auth"),J=class extends V{signUp(t){return $.post("/signup",t)}signIn(t){return $.post("/signin",t)}logout(){return $.post("/logout")}getUser(){return $.get("/user")}},G=new W("/user"),Z=new W("/chats"),Q={user:new class extends V{updatePassword(t){return G.put("/password",t)}updateAvatar(t){return G.put("/profile/avatar",Object.assign(Object.assign({},t),{headers:!0}))}updateProfile(t){return G.put("/profile",t)}searchUser(t){return G.post("/search",t)}},auth:new J,chat:new class extends V{createChat(t){return Z.post("",t)}deleteChat(t){return Z.delete("",t)}getChatList(){return Z.get("")}getChatUsers(t){return Z.get(`/${t}/users`)}addChatUser(t){return Z.put("/users",t)}deleteChatUser(t){return Z.delete("/users",t)}updateAvatar(t){return Z.put("/avatar",Object.assign(Object.assign({},t),{headers:!0}))}getToken(t){return Z.post(`/token/${t}`)}}};let X=y.getInstance();const Y={className:"account__switch-button",type:"",text:"Уже есть аккаунт",id:"switchToSignInButton"},K={className:"form__submit-button",type:"",e:"click",handler:h(q,"this.parentNode"),text:"Регистрация",id:"signUpButton"},tt={className:"form-container",id:"signUpForm",title:"Авторизация",submitButton:new g(K),inputs:[{lable:{className:"form__input__name",title:"ИМЯ"},input:{className:"form__input",type:"text",name:"first_name"},handler:h(f,"this")},{lable:{className:"form__input__name",title:"ФАМИЛИЯ"},input:{className:"form__input",type:"text",name:"second_name"},handler:h(f,"this")},{lable:{className:"form__input__name",title:"ЛОГИН"},input:{className:"form__input",type:"text",name:"login"},handler:h(f,"this")},{lable:{className:"form__input__name",title:"E-MAIL"},input:{className:"form__input",type:"email",name:"email",placeholder:"abcd@efg.hi"},handler:h(f,"this")},{lable:{className:"form__input__name",title:"ПАРОЛЬ"},input:{className:"form__input",type:"password",name:"password"},handler:h(f,"this")},{lable:{className:"form__input__name",title:"Телефон"},input:{className:"form__input",type:"text",name:"phone",placeholder:"+7 (777) 777-77-77"},handler:h(f,"this")}]};let et=y.getInstance(),nt=new J;const st=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="chat-list__container__list">\n                        <ul id="chatList">\n                        {{#each chats}}\n                            <li class="chat-list__item" id="{{this.id}}">\n                                <hr>\n                                <div class="chat-list__item__avatar__container">\n                                <img src="https://ya-praktikum.tech{{this.avatar}}" width="47px;" height="47px;" style="border-radius: 23.5px;" id="chat{{this.id}}Avatar"/>\n                                </div>\n                                <span class="chat-list__item__chat-author__container">{{this.title}}   <span class="chat-list__delete_button">&#10008;</span></span>\n                                <div class="chat-list__item__last-message__container">\n                                {{this.created_by}}\n                                </div>\n                                <span class="chat-list__item__time">{{ this.time }}</span>\n                            </li>\n                        {{/each}}\n                        </ul>\n                        <div style="display: flex; justify-content: center;">\n                            {{{createButton}}}\n                        </div>\n                    </div>',{chats:this.props.chats,createButton:this.props.createButton.render()})}},at=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="chat-list__container__profile-link">\n                        <span class="logout-button" id="logoutHeaderButton">\n                            {{logoutText}}\n                        </span>\n                        <a id="profileHeaderButton">\n                            {{linkText}}\n                        </a>\n                    </div>',{logoutText:this.props.logoutText,linkUrl:this.props.linkUrl,linkText:this.props.linkText})}},it=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="chat-list__search__container">\n                        <input class="chat-list__search__input" placeholder="Поиск..." />\n                    </div>',{})}},rt=class extends p{constructor(t){super("main",t)}render(){return this.compile('<main>\n                        <div class="workspace__wrapper">\n                            <div class="workspace__container">\n                            {{{content}}}\n                            </div>\n                        </div>\n                    </main>',{content:this.props.content.map((t=>t.render())).join("")})}};function ot(t){const e=document.getElementById(t);if(e){const t=e.querySelector(".dialog-modal__content"),n=e.querySelector(".dialog-modal__background");null==n||n.classList.add("open"),e.classList.add("open"),null==t||t.classList.add("open")}}function lt(t){const e=document.getElementById(t);if(e){const t=e.querySelector(".dialog-modal__content"),n=e.querySelector(".dialog-modal__background");null==n||n.classList.remove("open"),e.classList.remove("open"),null==t||t.classList.remove("open")}}window.openModal=ot,window.closeModal=lt;const ct={header:{logoutText:"Выйти",linkUrl:"./profile.html",linkText:"Профиль"},chats:[],createButton:new g({className:"form__submit-button",type:"submit",e:"click",text:"Новый чат",id:"newChatCreateButton"})},dt={messages:[{containerClass:"interlocutor-message-container",boxClass:"interlocutor-message-box",message:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Totam autem sint minima natus sit odio in. Iure aliquid quos nobis magnam aliquam blanditiis saepe. Tempora beatae ea fuga ex eligendi?"},{containerClass:"my-message-container",boxClass:"my-message-box",message:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Totam autem sint minima natus sit odio in. Iure aliquid quos nobis magnam aliquam blanditiis saepe. Tempora beatae ea fuga ex eligendi?"},{containerClass:"interlocutor-message-container",boxClass:"interlocutor-message-box",message:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Totam autem sint minima natus sit odio in. Iure aliquid quos nobis magnam aliquam blanditiis saepe. Tempora beatae ea fuga ex eligendi?"},{containerClass:"my-message-container",boxClass:"my-message-box",message:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Totam autem sint minima natus sit odio in. Iure aliquid quos nobis magnam aliquam blanditiis saepe. Tempora beatae ea fuga ex eligendi?"}],messageHandler:h(q,"this.parentNode")},pt={className:"form__submit-button",type:"submit",e:"click",handler:h(q,"this.parentNode"),text:"Новый чат",id:"newChatSubmitButton"},ut={className:"form-container",id:"newChat",title:"Новый чат",submitButton:new g(pt),inputs:[{lable:{className:"form__input__name",title:"Название чата"},input:{className:"form__input",type:"text",name:"title"},handler:h(f,"this")}]},ht={id:"newChatModal",modalHandler:h(lt,"'changeAvatarModal'"),form:new x(ut)},mt={header:{},usersToAdd:[],users:[{name:"Денис",avatarPath:""},{name:"Мама",avatarPath:""},{name:"Папа",avatarPath:""},{name:"Драконы комитет",avatarPath:""},{name:"Друг",avatarPath:""}],addUserButton:new g({className:"form__submit-button",type:"",e:"click",text:"Найти пользователя",id:"newChatUserAddButton"})},ft={className:"form__submit-button",type:"submit",e:"click",handler:h(q,"this.parentNode"),text:"Найти пользователя",id:"newChatUserSubmitButton"},gt={className:"form-container",id:"newChatUser",title:"Поиск пользователя по логину",submitButton:new g(ft),inputs:[{lable:{className:"form__input__name",title:"Пользователь"},input:{className:"form__input",type:"text",name:"login"},handler:h(f,"this")}]},_t={id:"newChatUserModal",modalHandler:h(lt,"'newChatUserModal'"),form:new x(gt)},bt={className:"form__submit-button",type:"submit",e:"click",handler:h(q,"this.parentNode"),text:"Сменить аватар",id:"changeChatAvatarButtonSubmit"},xt={className:"form-container",id:"changeChatAvatarForm",title:"Сменить аватар чата",submitButton:new g(bt),inputs:[{lable:{className:"form__input__name",title:"Выберите файл"},input:{className:"form__input",type:"file",name:"avatar"},handler:h(f,"this")}]},wt={id:"changeChatAvatar",modalHandler:h(lt,"'changeChatAvatar'"),form:new x(xt)},yt=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="chat-list__container">\n                        {{{content}}}\n                    </div>',{content:this.props.content.map((t=>t.render())).join("")})}},vt=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="chat-container">\n                            <div class="chat-container__interlocutor-container" id=\'changeChatAvatarButton\'>\n                                <div class="chat-container__interlocutor-container__avatar-container">\n                                <img src="{{currentChatAvatar}}" height="60px;" width="60px;" style="border-radius: 30px;"/>\n                                </div>\n                            <div class="chat-container__interlocutor-container__name">\n                                <p>{{currentChatTitle}}</p>\n                            </div>\n                            </div>\n                            <hr>\n                            <div class="messages-container">\n                                {{#each currentChatMessages}}\n                                <div class="{{this.containerClass}}">\n                                    <div class="{{this.boxClass}}">\n                                        <p>{{this.message.content}}</p>\n                                        <small><em>{{this.author}}</small></em>\n                                    </div>\n                                </div>\n                                {{/each}}\n                            </div>\n                            <hr>\n                            <div class="message-form__container">\n                            <form class="message-form" id="messageForm">\n                                <div class="message-form__file-attache-button">\n                                    &#128247;\n                                </div>\n                                <div class="message-form__message-input__container">\n                                    <input class="message-form__message-input" type="text" name="message" id="messageInput" />\n                                </div>\n                                <button class="message-form__send-button" type="submit"\n                                    onclick="{{messageHandler}}">\n                                    &#10148;\n                                </button>\n                            </form>\n                        </div>\n                    </div>',{messageHandler:this.props.messageHandler,currentChatTitle:this.props.currentChatTitle,currentChatAvatar:this.props.currentChatAvatar,currentChatMessages:this.props.currentChatMessages})}},Et=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div id={{id}} class="dialog-modal">\n                        <div class="dialog-modal__background">\n                        </div>\n                        <div class="dialog-modal__content">\n                            {{{form}}}\n                        </div>\n                    </div>',{id:this.props.id,form:this.props.form.render()})}},Tt=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="chat-users-list__container">\n                        {{{content}}}\n                    </div>',{content:this.props.content.map((t=>t.render())).join("")})}},Ot=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="chat-users-list__container__list">\n                        <span><h3>Участники чата</h3></span>\n                        <ul id="chatUsersList">\n                        {{#each users}}\n                            <li class="chat-users-list__item" id="{{this.id}}">\n                                <hr>\n                                <div class="chat-users-list__item__avatar__container">\n                                    <img src="https://ya-praktikum.tech{{this.avatar}}" width="47px;" height="47px;" style="border-radius: 23.5px;"/>\n                                </div>\n                                <span class="chat-users-list__item__chat-author__container">{{this.first_name}}  {{this.second_name}} <span class="chat-users-list__delete_button">&#10008;</span></span>\n                                <span class="chat-users-list__item__time">{{ this.time }}</span>\n                            </li>\n                        {{/each}}\n                        </ul>\n                        <ul id="usersToAddList">\n                        {{#each usersToAdd}}\n                            <li class="chat-users-list__item" id="{{this.id}}">\n                                <hr>\n                                <div class="chat-users-list__item__avatar__container">\n                                    <img src="https://ya-praktikum.tech{{this.avatar}}" width="47px;" height="47px;" style="border-radius: 23.5px;"/>\n                                </div>\n                                <span class="chat-users-list__item__chat-author__container">{{this.first_name}}  {{this.second_name}} <span class="chat-list__add-user_button">&#10004;</span></span>\n                                <span class="chat-users-list__item__time">{{this.time}}</span>\n                            </li>\n                        {{/each}}\n                        </ul>\n                        <div style="display: flex; justify-content: center;">\n                            {{{addUserButton}}}\n                        </div>\n                    </div>',{users:this.props.users,usersToAdd:this.props.usersToAdd,addUserButton:this.props.addUserButton.render()})}},kt=t=>{R({type:j,payload:t})},Ct=t=>{R({type:S,payload:t})},Nt=t=>{R({type:H,payload:t})},jt={initMessage:"...I'm still working on it))"},Lt=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="error-container">\n                        <p>{{initMessage}}</p>\n                    </div>',{initMessage:this.props.initMessage})}},St=y.getInstance(),Ut=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="profile-info__wrapper">\n                        <form class="profile-info-container" id="{{id}}">\n                            <span class="profile-info-container__property">Старый пароль</span>\n                                <input class="change-input" type="password" name="oldPassword" placeholder="старый пароль" onfocus="{{inputHandler}}" onblur="{{inputHandler}}"/>\n                            <hr />\n                            <span class="profile-info-container__property">Новый пароль пароль</span>\n                            <input class="change-input" type="password" name="newPassword" placeholder="новый пароль"  onfocus="{{inputHandler}}" onblur="{{inputHandler}}"/>\n                            {{{submitButton}}}\n                        </form>\n                    </div>',{id:this.props.id,formHandler:this.props.formHandler,inputHandler:this.props.inputHandler,submitButton:this.props.submitButton.render()})}},Pt=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="return-container">\n                        <a href="{{likUrl}}">\n                            <div class="return-container__button">\n                                <h1>❮</h1>\n                            </div>\n                        </a>\n                    </div>',{linkUrl:this.props.urlLink})}},Bt={className:"profile-info-container__submit-button",type:"submit",e:"click",handler:h(q,"this.parentNode"),text:"Изменить",id:"changePasswordSubmitButton"},At={linkUrl:"./profile"},It={id:"changePasswordForm",formHandler:h(q,"this.parentNode"),inputHandler:h(f,"this"),submitButton:new g(Bt)};let Ht=y.getInstance();const Dt=(h(q,"this.parentNode"),{id:"changeProfileForm",profileData:[{label:"Имя",inputType:"text",inputName:"first_name",inputPlaceholder:"имя",handler:h(f,"this")},{label:"Фамилия",inputType:"text",inputName:"second_name",inputPlaceholder:"Фамилия",handler:h(f,"this")},{label:"Псевдоним",inputType:"text",inputName:"display_name",inputPlaceholder:"ник",handler:h(f,"this")},{label:"Логин",inputType:"text",inputName:"login",inputPlaceholder:"Логин",handler:h(f,"this")},{label:"E-mail",inputType:"email",inputName:"email",inputPlaceholder:"mail",handler:h(f,"this")},{label:"Телефон",inputType:"text",inputName:"phone",inputPlaceholder:"+7-925-777-77-77",handler:h(f,"this")}],formHandler:h(q,"this.parentNode"),modalHandler:""}),Mt={linkUrl:"./chat.html"},Ft={className:"form__submit-button",type:"submit",e:"click",handler:h(q,"this.parentNode"),text:"Изменить аватар",id:"modalSubmitButtonCTX"},Rt={className:"form-container",id:"avatarChangeForm",title:"Изменить аватар",submitButton:new g(Ft),inputs:[{lable:{className:"form__input__name",title:"Выберите файл"},input:{className:"form__input",type:"file",name:"avatar"},handler:h(f,"this")}]},qt={id:"avatarForm",modalHandler:h(lt,"'changeAvatarModal'"),form:new x(Rt)},zt=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="profile-info__wrapper">\n                        <div class="profile-info-container">\n                            <form id="{{id}}" class="profile-info-container__form">\n                                <div class="profile-info-container__avatar" id="avatarOpenModalButton">\n                                <img src="https://ya-praktikum.tech{{avatarPath}}" class="profile-info-container__avatar" />\n                                </div>\n                                {{#each profileData}}\n                                    <div class="profile-info-container__item">\n                                        <div class="profile-info-container__item__prop-name">\n                                            <span class="profile-info-container__property">{{this.label}}</span>\n                                        </div>\n                                        <div class="profile-info-container__item__prop-input">\n                                            <input id="avatarInput" class="change-input" type="{{this.inputType}}" name="{{this.inputName}}" placeholder="{{this.inputPlaceholder}}"/>\n                                        </div>\n                                    </div>\n                                    <hr />\n                                {{/each}}\n                                <button class="modal-dialog__submit-button">Изменить</button>\n                            </form>\n                        </div>\n                    </div>',{id:this.props.id,profileData:this.props.profileData,formHandler:this.props.formHandler,modalHandler:this.props.modalHandler,avatarPath:this.props.avatarPath})}};let Wt=y.getInstance();const Vt=t=>{R({type:T,payload:t})},$t={errorCode:"404",errorMessage:"Такой страницы нет"},Jt=class extends p{constructor(t){super("div",t)}render(){return this.compile('<div class="error-container">\n                        <h1>{{errorCode}}</h1>\n                        <p>{{errorMessage}}</p>\n                    </div>',{errorCode:this.props.errorCode,errorMessage:this.props.errorMessage})}};var Gt=n(379),Zt=n.n(Gt),Qt=n(807);Zt()(Qt.Z,{insert:"head",singleton:!1}),Qt.Z.locals;const Xt=new o(".app");Xt.use("/",class extends p{constructor(){super("div",{content:new rt({content:[new Lt(jt)]})}),this.stateToProps=this.stateToProps.bind(this),St.subscribe(this.stateToProps)}show(){document.querySelector(".app").innerHTML="",i(".app",this)}componentDidMount(){var t;t=Q.auth.getUser(),R({type:T,payload:t})}componentDidUpdate(){return this.props.auth&&!0===this.props.auth.status&&Xt.go("/chats"),this.props.auth&&!1===this.props.auth.status&&Xt.go("/signin"),!0}hide(){document.querySelector(".app").innerHTML=""}stateToProps(){this.setProps({content:new rt({content:[new Lt(jt)]}),auth:St.state.auth})}render(){return this.compile("{{{content}}}",{content:this.props.content.render()})}}).use("/signin",class extends p{constructor(){super("div",{content:new u({content:[new x(b),new g(_)]})}),this.formHandler=t=>{t.preventDefault();let e=q(b.id);var n;e&&(n=Q.auth.signIn(e),R({type:v,payload:n}))},this.stateToProps=this.stateToProps.bind(this),X.subscribe(this.stateToProps)}stateToProps(){this.setProps({content:new u({content:[new x(b),new g(_)]}),auth:X.state.auth})}show(){document.querySelector(".app").innerHTML="",i(".app",this);let t=this.formHandler;document.getElementById("loginForm").addEventListener("submit",t)}addListeners(){let t=this.formHandler,e=document.getElementById("loginForm");e&&e.addEventListener("submit",t);const n=document.getElementById("switchToSignUpButton");null==n||n.addEventListener("click",(function(){Xt.go("/signup")}))}hide(){document.querySelector(".app").innerHTML=""}componentDidMount(){var t;t=Q.auth.getUser(),R({type:T,payload:t})}componentDidUpdate(){return this.props.auth&&!0===this.props.auth.status&&Xt.go("/chats"),!0}render(){return this.compile("{{{content}}}",{content:this.props.content.render()})}}).use("/signup",class extends p{constructor(){super("div",{content:new u({content:[new x(tt),new g(Y)]})}),this.formHandler=t=>{t.preventDefault();let e=q(tt.id);var n;e&&(n=nt.signUp(e),R({type:E,payload:n}))},this.stateToProps=this.stateToProps.bind(this),et.subscribe(this.stateToProps)}stateToProps(){this.setProps({content:new u({content:[new x(tt),new g(Y)]})})}addListeners(){let t=this.formHandler,e=document.getElementById("signUpForm");e&&e.addEventListener("submit",t);const n=document.getElementById("switchToSignInButton");null==n||n.addEventListener("click",(function(){Xt.go("/signin")}))}show(){i(".app",this);let t=this.formHandler;document.getElementById("signUpForm").addEventListener("submit",t)}hide(){document.querySelector(".app").innerHTML=""}componentDidMount(){var t;t=nt.getUser(),R({type:T,payload:t})}render(){return this.compile("{{{content}}}",{content:this.props.content.render()})}}).use("/chats",class extends p{constructor(){super("div",{content:new rt({content:[new yt({content:[new at(ct.header),new it(ct),new st(ct)]}),new vt(Object.assign(Object.assign({},dt),{currentChatTitle:D.state.currentChat?D.state.currentChat.title:"Нужно выбрать чат",currentChatAvatar:D.state.currentChat?D.state.currentChat.avatar:null,currentChatMessages:D.state.currentChatMessages})),new Tt({content:[new Ot(mt)]})]})}),this.chatAvatarFormHandler=t=>{t.preventDefault();const e=document.getElementById(xt.id),n=new FormData(e);var s;n.append("chatId",D.state.currentChat.id),s=Q.chat.updateAvatar({data:n}),R({type:A,payload:s}),lt("changeChatAvatar")},this.formHandler=t=>{t.preventDefault();let e=q(ut.id);var n;e&&(n=Q.chat.createChat(e),R({type:N,payload:n}))},this.addUserFormHandler=t=>{t.preventDefault();let e=q(_t.id);var n;e&&(n=Q.user.searchUser(e),R({type:U,payload:n}))},this.stateToProps=this.stateToProps.bind(this),D.subscribe(this.stateToProps),this.state={socket:null}}stateToProps(){this.setProps({content:new rt({content:[new yt({content:[new at(ct.header),new it(ct),new st(Object.assign(Object.assign({},ct),{chats:D.state.chats?D.state.chats.data:null}))]}),new vt(Object.assign(Object.assign({},dt),{currentChatTitle:D.state.currentChat?D.state.currentChat.title:"Нужно выбрать чат",currentChatAvatar:D.state.currentChat?D.state.currentChat.avatar:null,currentChatMessages:D.state.currentChatMessages})),new Tt({content:[new Ot(Object.assign(Object.assign({},mt),{users:D.state.chat?D.state.chat.users:null,usersToAdd:D.state.usersToAdd?D.state.usersToAdd:[]}))]}),new Et(ht),new Et(_t),new Et(wt)]}),auth:D.state.auth,chats:D.state.chats!==this.props.chats?D.state.chats:null,chat:D.state.chat!==this.props.chat?D.state.chat:null,usersToAdd:D.state.usersToAdd!==this.props.usersToAdd?D.state.usersToAdd:[],currentChatToken:D.state.currentChatToken!==this.props.currentChatToken?D.state.currentChatToken:this.props.currentChatToken})}componentDidMount(){var t;t=Q.auth.getUser(),R({type:T,payload:t}),kt(Q.chat.getChatList())}componentDidUpdate(){if(this.props.auth&&!1===this.props.auth.status)return Xt.go("/"),!0;if(this.props.chats&&!0===this.props.chats.listUpdated)return kt(Q.chat.getChatList()),!1;if(this.props.chat&&!0===this.props.chat.listUpdated)return Ct(Q.chat.getChatUsers(D.state.currentChat.id)),!1;if(D.state.currentChat&&D.state.currentChat.id&&null!==D.state.currentChatToken&&void 0!==D.state.currentChatToken&&this.props.currentChatToken!==D.state.currentChatToken){this.state.socket=function(t){const e=new WebSocket(`wss://ya-praktikum.tech/ws/chats${t}`);return e.addEventListener("open",(()=>{console.log("Соединение установлено"),e.send(JSON.stringify({content:"0",type:"get old"}))})),e.addEventListener("close",(t=>{t.wasClean?console.log("Соединение закрыто чисто"):console.log("Обрыв соединения"),console.log(`Код: ${t.code} | Причина: ${t.reason}`)})),e}(`/${D.state.user.id}/${D.state.currentChat.id}/${D.state.currentChatToken}`);const t=this.state.socket;return t.OPEN,t.addEventListener("message",(t=>{if(Array.isArray(JSON.parse(t.data))){let e=[];JSON.parse(t.data).map((t=>{t.user_id===D.state.user.id?e.push({containerClass:"my-message-container",boxClass:"my-message-box",message:t,author:"Me"}):e.push({containerClass:"interlocutor-message-container",boxClass:"interlocutor-message-box",message:t,author:D.state.chat.users.filter((e=>e.id===t.user_id))[0].login})})),Nt(e.reverse())}if("message"===JSON.parse(t.data).type){let e=[];JSON.parse(t.data).userId===D.state.user.id?e.push({containerClass:"my-message-container",boxClass:"my-message-box",message:JSON.parse(t.data),author:"Me"}):e.push({containerClass:"interlocutor-message-container",boxClass:"interlocutor-message-box",message:JSON.parse(t.data),author:D.state.chat.users.filter((e=>e.id===JSON.parse(t.data).userId))[0].login}),Nt(e)}})),!1}}show(){document.querySelector(".app").innerHTML="",i(".app",this)}hide(){document.querySelector(".app").innerHTML=""}addListeners(){let t=document.getElementById("logoutHeaderButton");null==t||t.addEventListener("click",(function(){var t;t=Q.auth.logout(),R({type:C,payload:t})}));let e=document.getElementById("profileHeaderButton");null==e||e.addEventListener("click",(function(){Xt.go("/profile")}));let n=document.getElementById("newChatCreateButton");null==n||n.addEventListener("click",(function(){ot("newChatModal")}));let s=document.getElementById("newChatUserAddButton");null==s||s.addEventListener("click",(function(){ot("newChatUserModal")}));let a=this.formHandler,i=document.getElementById(ut.id);i&&i.addEventListener("submit",a);let r=document.getElementById("chatList");null==r||r.addEventListener("click",(function(t){var e,n,s,a;let i=t.target,r=i;if(r&&r.classList.contains("chat-list__delete_button")){let t=Number(null===(e=r.closest("li"))||void 0===e?void 0:e.id),n={data:JSON.stringify({chatId:t})};o=Q.chat.deleteChat(n),R({type:L,payload:o})}var o;let l=i;if(l&&!l.classList.contains("chat-list__delete_button")){let t=Number(null===(n=l.closest("li"))||void 0===n?void 0:n.id);const e=null===(a=null===(s=l.closest("li"))||void 0===s?void 0:s.querySelector(".chat-list__item__chat-author__container"))||void 0===a?void 0:a.textContent,i=document.getElementById(`chat${t}Avatar`);y.setState(Object.assign(Object.assign({},D.state),{currentChat:Object.assign(Object.assign({},D.state.currentChat),{id:t,title:e,avatar:null==i?void 0:i.src})})),"active",l.closest("li").classList.toggle("active"),Ct(Q.chat.getChatUsers(t)),(t=>{R({type:I,payload:t})})(Q.chat.getToken(D.state.currentChat.id))}}));let o=this.addUserFormHandler;const l=document.getElementById("newChatUser");l&&l.addEventListener("submit",o);const c=document.getElementById("usersToAddList");null==c||c.addEventListener("click",(function(t){var e;const n=t.target;if(n&&n.classList.contains("chat-list__add-user_button")){let t=Number(null===(e=n.closest("li"))||void 0===e?void 0:e.id),a={data:JSON.stringify({users:[Number(t)],chatId:Number(D.state.currentChat.id)})};s=Q.chat.addChatUser(a),R({type:P,payload:s})}var s}));const d=document.getElementById("chatUsersList");null==d||d.addEventListener("click",(function(t){var e;const n=t.target;if(n&&n.classList.contains("chat-users-list__delete_button")){let t=Number(null===(e=n.closest("li"))||void 0===e?void 0:e.id),a={data:JSON.stringify({users:[Number(t)],chatId:Number(D.state.currentChat.id)})};s=Q.chat.deleteChatUser(a),R({type:B,payload:s})}var s}));const p=document.getElementById("changeChatAvatarButton");null==p||p.addEventListener("click",(function(){ot("changeChatAvatar")}));const u=document.getElementById("changeChatAvatarForm");null==u||u.addEventListener("submit",this.chatAvatarFormHandler);const h=document.getElementById("messageForm");h&&h.addEventListener("submit",(t=>{t.preventDefault();const e=document.getElementById("messageInput"),n=this.state.socket;1!==n.readyState&&n.OPEN,n.send(JSON.stringify({content:e?e.value:null,type:"message"}))}));const m=document.querySelector(".messages-container");m&&(m.scrollTop=m.scrollHeight)}render(){return this.compile("{{{content}}}",{content:this.props.content.render()})}}).use("/changepassword",class extends p{constructor(){super("div",{content:new rt({content:[new Pt(At),new Ut(It)]})}),this.formHandler=t=>{t.preventDefault();let e=q(It.id);var n;e&&(n=Q.user.updatePassword(e),R({type:O,payload:n}))},this.stateToProps=this.stateToProps.bind(this),Ht.subscribe(this.stateToProps)}stateToProps(){this.setProps({content:new rt({content:[new Pt(At),new Ut(It)]}),auth:Ht.state.auth})}show(){document.querySelector(".app").innerHTML="",i(".app",this);let t=this.formHandler;document.getElementById("changePasswordForm").addEventListener("submit",t)}hide(){document.querySelector(".app").innerHTML=""}addListeners(){let t=this.formHandler;document.getElementById("changePasswordForm").addEventListener("submit",t)}componentDidMount(){var t;t=Q.auth.getUser(),R({type:T,payload:t})}componentDidUpdate(){return this.props.auth&&!1===this.props.auth.status&&Xt.go("/"),!0}render(){return this.compile("{{{content}}}",{content:this.props.content.render()})}}).use("/profile",class extends p{constructor(){super("div",{content:new rt({content:[new Pt(Mt),new zt(Object.assign(Object.assign({},Dt),{avatarPath:Wt.state.user?Wt.state.user.avatar:""})),new Et(qt)]})}),this.avatarFormHandler=t=>{t.preventDefault();const e=document.getElementById(Rt.id),n=new FormData(e);var s;s=Q.user.updateAvatar({data:n}),R({type:k,payload:s})},this.profileFormHandler=t=>{t.preventDefault();let e=q(Dt.id);var n;e&&(n=Q.user.updateProfile(e),R({type:"ON_PROFILE_CHANGE",payload:n}))},this.stateToProps=this.stateToProps.bind(this),Wt.subscribe(this.stateToProps)}stateToProps(){this.setProps({content:new rt({content:[new Pt(Mt),new zt(Object.assign(Object.assign({},Dt),{avatarPath:Wt.state.user?Wt.state.user.avatar:""})),new Et(qt)]}),profileUpdated:!!Wt.state.userProfileUpdated&&Wt.state.userProfileUpdated})}show(){i(".app",this),this.addListeners()}hide(){document.querySelector(".app").innerHTML=""}addListeners(){const t=document.getElementById(Rt.id);null==t||t.addEventListener("submit",this.avatarFormHandler);let e=this.profileFormHandler;document.getElementById("changeProfileForm").addEventListener("submit",e);let n=document.getElementById("avatarOpenModalButton");null==n||n.addEventListener("click",(function(){ot("avatarForm")}))}componentDidMount(){Vt(Q.auth.getUser())}componentDidUpdate(){return this.props.profileUpdated&&!0===this.props.profileUpdated&&Vt(Q.auth.getUser()),!0}render(){return this.compile("{{{content}}}",{content:this.props.content.render()})}}).use("/404",class extends p{constructor(){super("div",{content:new rt({content:[new Jt($t)]})})}show(){i(".app",this)}render(){return this.compile("{{{content}}}",{content:this.props.content.render()})}}).start()}},e={};function n(s){if(e[s])return e[s].exports;var a=e[s]={id:s,exports:{}};return t[s](a,a.exports,n),a.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n(151)})();